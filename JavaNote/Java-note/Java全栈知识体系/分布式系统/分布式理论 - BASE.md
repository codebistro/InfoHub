# 分布式理论 - BASE

> BASE是“Basically Available, Soft state, Eventually consistent(基本可用、软状态、最终一致性)”的首字母缩写。其中的软状态和最终一致性这两种技巧擅于对付存在分区的场合，并因此提高了可用性。

- 分布式理论 - BASE
  - [什么是BASE](#什么是base)
  - [CAP 与 BASE 关系](#cap-与-base-关系)
  - [CAP 与 ACID 关系](#cap-与-acid-关系)

##  什么是BASE

> eBay 的架构师 Dan Pritchett 源于对大规模分布式系统的实践总结，在 ACM 上发表文章提出 BASE 理论，BASE 理论是对 CAP 理论的延伸，核心思想是即使无法做到强一致性（Strong Consistency，CAP 的一致性就是强一致性），但应用可以采用适合的方式达到最终一致性（Eventual Consitency）。

1. **Basically Available**（基本可用）分布式系统在出现不可预知故障的时候，允许损失部分可用性
2. **Soft state**（软状态）软状态也称为弱状态，和硬状态相对，是指允许系统中的数据存在中间状态，并认为该中间状态的存在不会影响系统的整体可用性，即允许系统在不同节点的数据副本之间进行数据同步的过程存在延时。
3. **Eventually consistent**（最终一致性）最终一致性强调的是系统中所有的数据副本，在经过一段时间的同步后，最终能够达到一个一致的状态。因此，最终一致性的本质是需要系统保证最终数据能够达到一致，而不需要实时保证系统数据的强一致性

### 什么是BASE理论√

BASE 是 **Basically Available(基本可用)、Soft state(软状态)和 Eventually consistent (最终一致性)** 三个短语的缩写。是对CAP中AP的一个扩展。

> 是对CAP 理论的延伸，思想是即使无法做到强一致性（CAP 的一致性就是强一致性），但可
> 以采用适当的采取弱一致性，即最终一致性。

1. 基本可用，Basically Available:**分布式系统在出现故障时，允许损失部分可用功能(例如响应时间、功能上的可用性），保证核心功能可用。**
   - 响应时间上的损失：正常情况下搜索引擎需要在0.5 秒之内返回给用户相应的
     查询结果，但由于出现故障（比如系统部分机房发生断电或断网故障），查询
     结果的响应时间增加到了1~2 秒。
   - 功能上的损失：购物网站在购物高峰（如双十一）时，为了保护系统的稳定性，
     部分消费者可能会被引导到一个降级页面。
2. 软状态:**允许系统中的数据存在中间状态**，这个状态不影响系统可用性，这里指的是CAP中的不一致。
   - 分布式存储中一般一份数据会有多个副本，允许不同副本同步的延时就是软状态的体
     现。mysql replication 的异步复制也是一种体现。
3. **最终一致:最终一致是指经过一段时间后，所有节点数据都将会达到一个一致的状态。**
   - 最终一致性是指系统中的所有数据副本经过一定时间后，最终能够达到一致的状
     态。弱一致性和强一致性相反，最终一致性是弱一致性的一种特殊情况。

BASE解决了CAP中理论没有网络延迟，在BASE中用软状态和最终一致，保证了延迟后的一致性。BASE和 ACID 是相反的，它完全不同于ACID的强一致性模型，而是通过牺牲强一致性来获得可用性，并允许数据在一段时间内是不一致的，但最终达到一致状态。



##  CAP 与 BASE 关系

BASE是对CAP中一致性和可用性权衡的结果，其来源于对大规模互联网系统分布式实践的结论，是基于CAP定理逐步演化而来的，其核心思想是即使无法做到强一致性（Strong consistency），更具体地说，是对 CAP 中 AP 方案的一个补充。其基本思路就是：通过业务，牺牲强一致性而获得可用性，并允许数据在一段时间内是不一致的，但是最终达到一致性状态。

![img](img/img_%E5%88%86%E5%B8%83%E5%BC%8F%E7%90%86%E8%AE%BA%20-%20BASE/arch-cap-2.png)

##  CAP 与 ACID 关系

ACID 是传统数据库常用的设计理念，追求强一致性模型。BASE 支持的是大型分布式系统，提出通过牺牲强一致性获得高可用性。

ACID 和 BASE 代表了两种截然相反的设计哲学，在分布式系统设计的场景中，系统组件对一致性要求是不同的，因此 ACID 和 BASE 又会结合使用。

------

## Reference

 原文链接：https://pdai.tech/md/dev-spec/spec/dev-th-base.html